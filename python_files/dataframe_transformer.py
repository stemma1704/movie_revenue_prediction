import datetime

import numpy as np
import pandas as pd


class DataframeTransformer:

    @staticmethod
    def _has_collection(x):
        if pd.isnull(x):
            return 0
        return 1

    @staticmethod
    def transformer(X):

        X["release_date"] = pd.to_datetime(X["release_date"], infer_datetime_format=True)
        X["belongs_to_collection_updated"] = X["belongs_to_collection"].apply(DataframeTransformer._has_collection)
        # add weekday
        X["release_weekday"] = X["release_date"].dt.day_name()
        # Log of budget
        #         X['log_budget'] = np.log(X['budget'])
        # find age of movie
        now = pd.to_datetime("now")
        X["release_age"] = (now - X["release_date"]).astype("<m8[Y]")

        X["week_sin"] = np.sin(2 * np.pi * X["release_date"].dt.isocalendar().week / 52)

        X["week_cos"] = np.cos(2 * np.pi * X["release_date"].dt.isocalendar().week / 52)

        # budget to year ratio
        X["budget_year_ratio"] = round(X["budget"] / X["release_date"].dt.year, 2)
        return X

    @staticmethod
    def add_column_names(X):
        columns_df = [
'runtime', 'release_age', 'production_companies_number', 'production_countries_number', 'popularity', 'vote_average', 'vote_count',
'actor_number', 'director_number', 'producer_number', 'budget_year_ratio','week_cos','week_sin','belongs_to_collection_updated',
'genre_Drama',
'genre_Family',
'genre_Romance',
'genre_Music',
'genre_History',
'genre_Action',
'genre_Comedy',
'genre_Horror',
'genre_Thriller',
'genre_War',
'genre_Adventure',
'genre_Documentary',
'genre_Foreign',
'genre_Fantasy',
'genre_Crime',
'genre_Animation',
'genre_Science Fiction',
'genre_Mystery',
'genre_Western',
'genre_TV Movie',
'actor_Nicolas Cage',
'actor_Johnny Depp',
'actor_Ajith Kumar',
'actor_Bruce Willis',
'actor_Tom Cruise',
'actor_Denzel Washington',
'actor_Tom Hanks',
'actor_Adam Sandler',
'actor_Robert De Niro',
'actor_John Travolta',
'actor_Eddie Murphy',
'actor_John Wayne',
'actor_Keanu Reeves',
'actor_Arnold Schwarzenegger',
'actor_Ben Affleck',
'actor_Jeff Bridges',
'actor_George Clooney',
'actor_Harrison Ford',
'actor_Matt Damon',
'actor_Liam Neeson',
'actor_Kevin Costner',
'actor_Mark Wahlberg',
'actor_Clint Eastwood',
'actor_Jason Statham',
'actor_Mel Gibson',
'actor_Jackie Chan',
'actor_Sylvester Stallone',
'actor_Meryl Streep',
'actor_Ben Stiller',
'actor_Christian Bale',
'director_Steven Spielberg',
'director_Woody Allen',
'director_Ridley Scott',
'director_Alfred Hitchcock',
'director_Clint Eastwood',
'director_Steven Soderbergh',
'director_Oliver Stone',
'director_Martin Scorsese',
'director_Robert Rodriguez',
'director_John Carpenter',
'director_Tim Burton',
'director_John Ford',
'director_Wes Craven',
'director_Francis Ford Coppola',
'director_Ron Howard',
'director_Roland Emmerich',
'director_Robert Zemeckis',
'director_Michael Bay',
'director_Billy Wilder',
'director_Bobby Farrelly',
'director_Renny Harlin',
'director_Sam Raimi',
'director_Peter Jackson',
'director_Walter Hill',
'director_Tony Scott',
'director_Richard Donner',
'director_Brian De Palma',
'director_Barry Levinson',
'director_Spike Lee',
'director_John Landis',
'producer_Joel Silver',
'producer_Jerry Bruckheimer',
'producer_Brian Grazer',
'producer_Neal H. Moritz',
'producer_Tim Bevan',
'producer_Luc Besson',
'producer_John Davis',
'producer_Michael Bay',
'producer_Scott Rudin',
'producer_Arnon Milchan',
'producer_Danny DeVito',
'producer_Clint Eastwood',
'producer_Roger Birnbaum',
'producer_Ridley Scott',
'producer_Charles Roven',
'producer_Steve Golin',
'producer_Ronnie Screwvala',
'producer_Albert R. Broccoli',
'producer_Lawrence Gordon',
'producer_Walt Disney',
'producer_Tom Rosenberg',
'producer_Gale Anne Hurd',
'producer_Alfred Hitchcock',
'producer_Lawrence Bender',
'producer_Kathleen Kennedy',
'producer_Nick Wechsler',
'producer_Steven Spielberg',
'producer_John Hughes',
'producer_Judd Apatow',
'producer_Robert Rodriguez',
'productionCompany_Universal Pictures',
'productionCompany_Paramount Pictures',
'productionCompany_Twentieth Century Fox Film Corporation',
'productionCompany_Columbia Pictures',
'productionCompany_New Line Cinema',
'productionCompany_Walt Disney Pictures',
'productionCompany_Warner Bros.',
'productionCompany_Metro-Goldwyn-Mayer (MGM)',
'productionCompany_United Artists',
'productionCompany_Columbia Pictures Corporation',
'productionCompany_Miramax Films',
'productionCompany_TriStar Pictures',
'productionCompany_Village Roadshow Pictures',
'productionCompany_DreamWorks SKG',
'productionCompany_Fox Searchlight Pictures',
'productionCompany_Summit Entertainment',
'productionCompany_Touchstone Pictures',
'productionCompany_Orion Pictures',
'productionCompany_Lions Gate Films',
'productionCompany_BBC Films',
'productionCompany_Lionsgate',
'productionCompany_Imagine Entertainment',
'productionCompany_The Weinstein Company',
'productionCompany_Regency Enterprises',
'productionCompany_RKO Radio Pictures',
'productionCompany_Hollywood Pictures',
'productionCompany_Lakeshore Entertainment',
'productionCompany_StudioCanal',
'productionCompany_Lucasfilm',
'productionCompany_Dimension Films',
'productionCountry_United States of America',
'productionCountry_United Kingdom',
'productionCountry_India',
'productionCountry_France',
'productionCountry_Germany',
'productionCountry_Canada',
'productionCountry_Australia',
'productionCountry_Russia',
'productionCountry_Japan',
'productionCountry_Italy',
'productionCountry_China',
'productionCountry_Spain',
'productionCountry_Ireland',
'productionCountry_Hong Kong',
'productionCountry_South Korea',
'productionCountry_Mexico',
'productionCountry_Belgium',
'productionCountry_New Zealand',
'productionCountry_Czech Republic',
'productionCountry_Denmark',
'productionCountry_Netherlands',
'productionCountry_Switzerland',
'productionCountry_Singapore',
'productionCountry_Israel',
'productionCountry_Brazil',
'productionCountry_Thailand',
'productionCountry_United Arab Emirates',
'productionCountry_Norway',
'productionCountry_Sweden',
'productionCountry_Finland',
]
        return pd.DataFrame(X,columns=columns_df)
